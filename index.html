<!-- Author: Benjamin Pipes

    This is website for practicing various JS and JS API operations

-->

<!DOCTYPE html>
<html lang="en">
<head>
  <title>Pipes' Practice Site</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <link rel="stylesheet" href="style.css" type="text/css"/>
  <link rel="shortcut icon" href="#">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
</head>
<body>
    
    <!-- i is the count of rows. i is one because a dummy tuple is hardcoded-->
    <script>var i=1;</script>
    
<script>
    
$(document).ready(function(){
    $("#submitbutton").click(function(){
 
    var name = $("#namefield").val();
    var dob = $('#dobfield').val();
    var age = $('#agefield').val();
 
    var re = /^[0-9]*$/g; //regex for age
    var pre =   /^[0-9]*$/g;        //regex for dob
 
    if ((age < 1 || age > 99) || !re.test(age)){
        alert("Invalid age input.");
        }
    else if (!pre.test(dob) || dob.length > 8){
        alert("Invalid dob input");
    }
    else{
        var tr = "<tr id=r" + i + ">\
        <td id=" + "dn" + ">" + name + "</td>\n\
        <td id=" + "dd" + ">" + dob + "</td>\n\
        <td id=" + "da" + ">" + age + "</td>\n\
        <td id=" + "index" + ">" + i + "</td></tr>";
            
       
        if(checkDupe(name, dob, age)){
            $("table tbody").append(tr);
            i++;
        }
        else
            alert("Duplicate tuple! Each entry should be unique.");
    }
    });//submitbutton
});//document ready

function checkDupe(name, dob, age){
    //if table has no tuples
    if (i === 0){
        console.log("i is zero");
        return false;
    }
    var n, d, a;
    
    //get each data field.
    n = document.getElementById("employeeTable").rows[i].cells.namedItem("dn").innerHTML;
    d = document.getElementById("employeeTable").rows[i].cells.namedItem("dd").innerHTML;
    a = document.getElementById("employeeTable").rows[i].cells.namedItem("da").innerHTML;
  
  
    if (name === n || dob === d || age === a)
        return false;
    else
        return true;
    
    console.log("testing against: " + n + " " + d + " " + a + " num " + i
            +"\n" + "row to check: " + (i - 1));
}

</script>

<div class="jumbotron text-center">
    <div class="container">
          <img src="images/no.jpg" class="img-circle" alt="" width="200" height="175"> 
        </div>
    
  <h1>TEST WEBSITE </h1>
  <p>some text</p> 
</div>
  
<form id="tableForm1" class="centerform">
    <input type="text" id="namefield" value="joe" placeholder="name...">
    <input type="text" id="dobfield" value="02111938" placeholder="dob...">
    <input type="text" id="agefield" value="35" placeholder="age...">
    <input type="button" id="submitbutton" value="Insert">
</form>



<div class="container">
    <div class="bootstrap-table">
    <table class="table table-striped" id="employeeTable">
        <thead>
            <tr>
            <th id="hdn">name</th>
            <th id="hdd">dob</th>
            <th id="hda">age</th>
            <th id="hdi">n</th>
            </tr>
        </thead>
        <tbody>
            <tr id="r0" >
                <td id="dn"> bob </td>
                <td id="dd"> 12201960 </td>
                <td id="da"> 89</td>
                <td id="index"> 0 </td>
            </tr>
        </tbody>
    </table>
    </div>
</div>


    <div class='navbar navbar-fixed-bottom'>
        <div class="sig">
            <a href="http://www.github.com/pipesbj" target="_blank">Github</a>
            <a href="mailto:pipesbj@gmail.com">Email</a>
        </div>
    </div>
</body>
</html>
